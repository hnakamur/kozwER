<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>Diagram using Raphael</title>
<script type="text/javascript" src="raphael.js"></script>
<script type="text/javascript" src="geom2d.js"></script>
<script type="text/javascript" src="minj.js"></script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="er_diagram.js"></script>
<script type="text/javascript" src="raphael.kozw.js"></script>
<script type="text/javascript">
window.onload = function() {
  var himoku_tbl = new er.Table('himoku_tbl', {
    name: '費目',
    columns: ['費目C', '費目名', '収支区分', '…'],
    data: [
      ['10', '給与収入', '収入'],
      ['11', '雑収入', '収入'],
      ['20', '食費', '支出'],
      ['21', '光熱費', '支出']
    ]
  });

  var monthly_deal_summary_tbl = new er.Table('monthly_deal_summary_tbl', {
    name: '月次収支取引サマリー',
    columns: ['費目C', '年月', '取引合計欄', '…'],
    pkeyColumnCount: 2,
    data: [
      ['10', 'XX/05', 0],
      ['11', 'XX/05', 0],
      ['20', 'XX/05', 4900],
      ['21', 'XX/05', 7800]
    ]
  });

  var deal_detail_tbl = new er.Table('deal_detail_tbl', {
    name: '収支取引明細',
    columns: ['取引No', '取引日', '費目C', '取引額', '摘要', '(年月)', '…'],
    data: [
      ['01234', 'XX/05/02', '20', 2500, 'スーパーヤマダ', 'XX/05'],
      ['01235', 'XX/05/03', '20', 600, 'コンビニKKK', 'XX/05'],
      ['01236', 'XX/05/05', '20', 1800, 'スーパーヤマダ', 'XX/05'],
      ['01237', 'XX/05/05', '21', 7800, '帝国電力引落し', 'XX/05'],
    ]
  });

  var paper = Raphael("canvas", 640, 480);
  var himoku_elems = paper.kozw.table(20, 20, himoku_tbl);
  var bbox = himoku_elems.getBBox(),
      x = bbox.x + 40,
      y = bbox.y + bbox.height + 30;
  var monthly_deal_summary_elems = paper.kozw.table(x, y, monthly_deal_summary_tbl);

  bbox = monthly_deal_summary_elems.getBBox();
  x = bbox.x + 40;
  y = bbox.y + bbox.height + 30;
  var deal_detail_elems = paper.kozw.table(x, y, deal_detail_tbl);

  var connectors = [
    new er.Connector(
      himoku_tbl.addConnectorEnd('one', 'bottom'),
      monthly_deal_summary_tbl.addConnectorEnd('multi', 'left')
    ),
    new er.Connector(
      monthly_deal_summary_tbl.addConnectorEnd('one', 'bottom'),
      deal_detail_tbl.addConnectorEnd('ref', 'left')
    )
  ];
  for (var i = 0, len = connectors.length; i < len; i++) {
    paper.kozw.connector(connectors[i]);
  }
};
</script>
<style type="text/css">
</style>
</head>
<body>
  <div id="canvas"></div>
</body>
</html>

