<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>図5.7 回帰を含む「部品表」のデータモデル</title>
<script type="text/javascript" src="raphael.js"></script>
<script type="text/javascript" src="array.js"></script>
<script type="text/javascript" src="raphael.kozw.js"></script>
<script type="text/javascript">
window.onload = function() {
  var FixedDigits = 2;

  function toFixedA(x) {
    return x.toFixed(FixedDigits).replace(/(\.[1-9]+)0+$|\.0+$/, "$1");
  }

  function toFixedB(x) {
    var s = x.toFixed(FixedDigits);
    var c;
    for (var i = s.length - 1; i >= 0; i--) {
      c = s.charAt(i);
      if (c != "0" && c != ".") {
        return s.substring(0, i + 1);
      }
    }
    return c;
  }

  var values = [2.01, 2.1, 2, 0];
  var count = 100000;

  var start = new Date();
  for (var i = 0; i < count; i++) {
    values.forEach(function(value) {toFixedA(value)});
  }
  var end = new Date();
  console.log("toFixedA: " + (end.getTime() - start.getTime()) / 1000);

  var start = new Date();
  for (var i = 0; i < count; i++) {
    values.forEach(function(value) {toFixedB(value)});
  }
  var end = new Date();
  console.log("toFixedB: " + (end.getTime() - start.getTime()) / 1000);
};
</script>
</head>
<body>
  <div id="canvas"></div>
</body>
</html>

